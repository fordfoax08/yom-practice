<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <!-- <link rel="stylesheet" href="asset/main.css"> -->
     <style>
        html,body{
    height: 100%;
    box-sizing: border-box;
}

#script-main-ticket,
#main-textarea-ticket,
      .ticket-write textarea,
#tips-textarea,
.dialog-textarea-create-template,
.dialog-textarea-create-steps,
.dialog-textarea-create-tips,
.dialog-textarea-create-template-child,
.textarea-dialog-edit-body,
.full-textarea{
    width: 100%;
    resize: none;
}

.steps-container > p:nth-of-type(odd){
background-color: hsl(219, 70%, 96%);
}

.steps-container > p:hover{
font-weight: bold;
}

.ts-steps-list{
    cursor: pointer;
}

.troubleshooting-steps-container{
    margin: 0px;
    padding: 0px;
}

.troubleshooting-steps-container > div{
    min-width: 100%;
    max-height: 300px;
    overflow-y: scroll;
}

.tips-div > div:nth-child(1){
    max-height: 250px;
    overflow-y: scroll;
}

.tips-div > div:nth-child(1)::-webkit-scrollbar {
width: 5px;
}

.tips-div > div:nth-child(1)::-webkit-scrollbar-track {
box-shadow: inset 0 0 6px rgba(174, 174, 174, 0.3);
}

.tips-div > div:nth-child(1)::-webkit-scrollbar-thumb {
background-color: darkgrey;
outline: 1px solid rgb(162, 171, 181);
}

.has-background-danger-light{
    transition: 1s all ease-in-out;
}


.bg-color{
    background-color: rgb(173, 252, 196);
    transition: .5s all ease-in-out;
}



/* DIALOG POPUP */
.dialog-popup{
    min-width: 95%;
    min-height: 90%;
}



.dialog-popup::-webkit-scrollbar {
    width: 5px;
}

.dialog-popup::-webkit-scrollbar-track {
    box-shadow: inset 0 0 6px rgba(174, 174, 174, 0.3);
}

.dialog-popup::-webkit-scrollbar-thumb {
    background-color: darkgrey;
    outline: 1px solid rgb(162, 171, 181);
}



.dialog-menu-ul > ul{
    list-style-type: none;
    padding: 14px;

}

.dialog-menu-ul > ul > li > p{
    margin-left: 15px;
    color: gray;
    font-size: .8em;
}

.menu-label{
    color:rgb(35, 35, 35);
}

.menu-label:hover{
    text-shadow: 1px 1px 2px rgb(45, 45, 45);
}

.menu-label > svg{
    visibility: hidden;
}
.menu-label:hover > svg{
    visibility: visible !important;
}


.remove-ts-data-btn:hover{
    /* background-color: rgba(0,0,0,.1); */
    text-shadow: 1px 1px 1px rgb(51, 51, 51);
}

.remove-ts-data-btn > span:nth-child(1){
    visibility: hidden;
}

.remove-ts-data-btn:hover > span:nth-child(1){
    visibility: visible !important;
}






.tag-success{
    position: absolute;
    z-index: 9999;
    top: 0;
    left: 0;
    opacity:0;
    transition: 1s all ease-in-out;
  }
  .tag-success.tag-show{
    opacity: 1;
    transition: 1s all ease-in-out;
  }



.enable-line-break{
    white-space: pre-wrap !important;
    /* max-width: 10%; */
    /* padding: 2px 9px 2px 9px !important; */
    text-align: left !important;
}



/* DIALOG POPUP */
.dialog-settings{
    min-width: 100%;
    min-height: 100%;
}



/*SECTION HELPER */
.section-helper{
    background-color: white;
    position: sticky;
    left: 0;
    right: 0;
    bottom: 0;
    height: 30px;
    border-top: 1px solid gray;
}.active.section-helper{
    position: absolute;
    left: 0;
    right: 0;
    bottom: -10px;
    height: 50%;
    /* overflow: hidden; */
    
}

.section-helper-drag{
    position: absolute;
    /* height: 20px; */
    top: -10px;
    left: 50%;
  transform: translate(-50%, -100%); /* Key part */
  transform: scale(0.5);
  cursor: n-resize;
}
     </style>
</head>
<body>
    <nav class="navbar is-dark" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
          <a class="navbar-item" onclick="dialogSettings()">
            <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><style>svg{fill:#ffffff}</style><path d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"/></svg>
          </a>
     
          <a  onclick="dialogPop()" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>
        </div>
     
        <div id="navbarBasicExample" class="navbar-menu">
         
     
          <div class="navbar-end">
            <div class="navbar-item">
              <div class="buttons">
                <a onclick="dialogPop()" class="button is-primary">
                  <strong>Menu</strong>
                </a>
              </div>
            </div>
          </div>
        </div>
    </nav>
   
    <section class="container section-1">
        <div class="message ticket-write">
            <div class="message-body pb-1">
                <textarea placeholder="SCRIPT" class="textarea-write-1 p-1 is-italic" name="" id="script-main-ticket" cols="30" rows="5"></textarea>
                <textarea placeholder="Template select template" class="textarea-write-2 p-1 is-size-7 copyable-input" name="" id="main-textarea-ticket" cols="30" rows="10"></textarea>
                <div class="container columns is-mobile is-multiline mt-1">
                    <!-- FOR PIN FAILURE -->
                    <div class="column is-7-mobile is-hidden input-group-pin-failure">
                        <input type="text" id="input-ticket-pin-name" class="input is-small mb-1 has-text-weight-semibold copyable-input is-link" placeholder="User's Full name">
                        <input type="text" id="input-ticket-pin-number" class="input is-small mb-1 has-text-weight-semibold copyable-input is-link" placeholder="PIN Number">
                        <input type="text" id="input-ticket-pin-password" class="input is-small mb-1 has-text-weight-semibold copyable-input is-link" placeholder="Temporary Password">
                        <input type="text" id="input-ticket-pin-manager" class="input is-small mb-1 has-text-weight-semibold copyable-input is-link" placeholder="Manager's name">
                    </div>
                    <div class="column is-7-mobile input-group-general">
                        <input type="text" id="input-ticket-write-domain" class="input is-small mb-1 has-text-weight-semibold copyable-input" placeholder="Domain ID">
                        <input type="text" id="input-ticket-write-name" class="input is-small mb-1 has-text-weight-semibold copyable-input" placeholder="Employee name">
                        <input type="text" id="input-ticket-write-number" class="input is-small mb-1 has-text-weight-semibold copyable-input" placeholder="Contact number">
                        <input type="text" id="input-ticket-write-device" class="input is-small mb-1 has-text-weight-semibold copyable-input" placeholder="Device name">
                    </div>
                    <div class="column">
                        <button class="button is-fullwidth p-5 is-primary btn-add-details">ADD DETAILS</button>
                        <button class="button is-small is-fullwidth mt-1 is-info btn-home-save-fields">Save</button>
                        <button class="button is-small is-fullwidth mt-1 is-danger is-5-mobile btn-clear-fields">Clear</button>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <section class="container section-2 pb-3">
        <!-- TABS BUTTON -->
        <div class="tabs is-centered is-boxed is-small is-right mb-0 pl-5">
            <ul class="select-steps-ul">
                <li data-target="tab-template" class="is-active">
                <a>
                    <span>Template</span>
                </a>
                </li>
                <li data-target="tab-steps">
                <a>
                    <span>TS steps</span>
                </a>
                </li>
                <li data-target="tab-tips">
                <a>
                    <span>Tips</span>
                </a>
                </li>
            </ul>
        </div>


        <!-- TABS Container -->
        <div class="container m-0 p-0 tab-home">
            <!-- can be hidden -->
            <!-- FOR TROUBLESHOOTING TAB -->

        <!-- TEMPLATES -->
            <div class="container home-select-template-container pl-5 pr-5 pt-3" id="tab-template">
                <p class="title is-size-7 mb-1">Select Template</p>
                <!-- List of Tickets -->
                -NO DATA!-
                <!--                 <div class="container ticket-select-container">
                    <button onclick="templateSelect(this)" class="button is-small is-fullwidth is-warning is-light mb-1">Password Reset</button>
                    <span class="tab-items-span is-hidden">
                        <ul>
                            <li>
                                <label class="radio is-size-7 has-text-weight-semibold">
                                    <input type="radio" name="ticket-template" id="">
                                    Password reset
                                </label>
                            </li>
                        </ul>
                    </span>  
                </div>
                 -->

   

            </div>

        <!-- STEPS -->
            <div class="container pr-5 pl-5 is-hidden" id="tab-steps">
                <p class="title is-size-7 mb-0 pb-2">Select Troubleshooting steps to add</p>
                <div class="container troubleshooting-steps-container content hero p-0 m-0">
                    <div class="container steps-container hero-body p-0 m-0">
                        -NO DATA!-
                        <!-- <p class="p-0 is-size-7 mb-1 ts-steps-list"><span class="has-text-danger">♦</span>  <span>Lorem ipsum dolor sit amet consectetur adipisicing elit. Laudantium harum sequi mollitia laboriosam ipsum quae quibusdam distinctio quidem, magnam odit alias? Aperiam quam similique, alias quidem quia voluptatum eum eligendi praesentium quisquam ipsum dicta aliquid perferendis blanditiis consequatur non provident rem dolorum commodi et eos minus porro. Ab, in.</span></p> -->
                       
                    </div>
                </div>
            </div>

        <!-- TIPS -->
            <div class="container pr-5 pl-5 is-hidden" id="tab-tips">
                <p class="title is-size-6 mb-1">TIPS</p>
                <div class="container tips-container hero m-0 p-0">
                    <div class="columns tips-div hero-body is-mobile is-multiline m-0 p-0">
                        <div class="column is-4 m-0 p-0 home-tips-container">
                            -NO DATA!-
                            <!-- <button class="button is-small is-fullwidth is-warning mb-1">VPN/COnnection</button> -->
                        </div>
                        <div class="column m-0 p-0">
                            <textarea class="ml-2 full-textarea is-size-7 p-1" name="" id="home-tips-textarea" cols="30" rows="15"></textarea>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </section>

    <!-- SECTION for HELPER -->
    <section class="container p-0 m-0 section-helper">
        <button class="button section-helper-drag is-small is-dark"> | | | </button>
        <div class="cointainer">
            <!-- HELPER TAB -->
            <div class="tabs is-centered is-boxed is-small pt-5">
                <ul class="helper-tab-ul">
                    <li data-target="helper-title-tab" class="is-active">
                    <a>
                        <span>Title</span>
                    </a>
                    </li>
                    <li data-target="helper-correction-tab">
                    <a>
                        <span>Correction</span>
                    </a>
                    </li>
                    <li data-target="helper-other-tab">
                    <a>
                        <span>Steps</span>
                    </a>
                    </li>
                    <li data-target="helper-important-tab">
                    <a>
                        <span>Important</span>
                    </a>
                    </li>
                </ul>
            </div>

            <!-- DIALOG SETTINGS CONTENT -->
            <div class="container helper-container-divs">
                <!-- History tab -->
                <div class="container" id="helper-title-tab">
                    <div class="message is-small">
                        <div class="message-header">Create title</div>
                        <div class="message-body pt-1 pb-1">
                            <p class="subtitle p-0 m-2 is-7 has-text-danger-dark">Explain problem in general, do not include sensitive info.</p>
                            <textarea placeholder="Issue" donpaste="return false;" name="" id="textarea-dialog-title" cols="30" rows="5" class="full-textarea p-1"></textarea>
                            <textarea placeholder="Result" name="" id="textarea-dialog-title-result" cols="30" rows="12" class="full-textarea mt-2 p-1"></textarea>
                            <button class="button is-success is-small" id="btn-generate-title">GENERATE</button>
                        </div>
                    </div>
                    <div class="message mt-3 is-danger is-small">
                        <div class="message-body">
                            <p>Based on the input it will generate a 3 title <br>make sure not to include sensitive information <br>paste is disabled</p>
                        </div>
                    </div>

                </div>

                <!-- Correction Tab -->
                <div class="container is-hidden" id="helper-correction-tab">
                    <div class="message is-small">
                        <div class="message-header">Translate and Rephrase</div>
                        <div class="message-body pt-1 pb-1">
                            <p class="subtitle p-0 m-2 is-7 has-text-danger-dark">Explain problem in general, do not include sensitive info.</p>
                            <textarea name="" cols="30" rows="5" class="full-textarea p-1 is-size-7" id="textarea-dialog-correction"></textarea>
                            <textarea name="" cols="30" rows="9" class="full-textarea p-1 is-size-7" id="textarea-dialog-correction-result"></textarea>
                            <button class="button is-success is-small" id="btn-generate-correction">GENERATE</button>
                        </div>
                    </div>
                    <div class="message is-danger is-small">
                        <div class="message-body">
                            <p>♦ This tab will function like Gramarly</p>
                            <p>♦ Enter your text and click "Generate" for a translation and/or correction.</p>
                            <p>♦ !!! IMPORTANT not to include user's info or data, although this won't upload any information, best practice lang. </p>
                        </div>
                    </div>
                </div>

                <!-- Bullet Tab -->
                <div class="container is-hidden" id="helper-other-tab">
                <div class="message is-small">
                    <div class="message-header">Bulleted</div>
                    <div class="message-body pt-1 pb-1">
                        <p class="subtitle p-0 m-2 is-7 has-text-danger-dark">Explain problem in general, do not include sensitive info.</p>
                        <textarea name="" cols="30" rows="5" class="full-textarea p-1 is-size-7" id="textarea-dialog-bullet"></textarea>
                        <textarea name="" cols="30" rows="9" class="full-textarea p-1 is-size-7" id="textarea-dialog-bullet-result"></textarea>
                        <button class="button is-success is-small" id="btn-generate-bullet">GENERATE</button>
                    </div>

                    <div class="message is-danger is-small mt-3">
                        <div class="message-body">
                            <p>♦ !!! IMPORTANT not to include user's info or data, although this won't upload any information, best practice lang. </p>
                            <p>♦ This tab creates a clear, step-by-step procedure from your input, presented in a bulleted style.</p>
                        </div>
                    </div>
                </div>
                
                </div>

                <!-- Reset Tab -->
                <div class="container is-hidden  p-5" id="helper-important-tab">
                    <div class="message is-danger is-small">
                        <div class="message-header">Important reminder</div>
                        <div class="message-body">
                            <div class="message is-warning is-small">
                                <div class="message-body">
                                    <p>♦ I created this app for personal use only</p>
                                    <p>♦ This little app doesn't upload any data, </p>
                                </div>
                            </div>
                        </div>
                    </div>
                
                </div>

            </div>










        </div>
    </section>







    <!-- DIALOG MAIN -->
    <dialog class="dialog-main has-background-danger-light">
       

        <div class="container dialog-main-container">
            --data here--
        </div>
        <button class="button is-danger is-small is-pulled-right mr-2 btn-dialog-main-no">Hindi</button>
    </dialog>


    <!-- DIALOG MENU -->
    <dialog class="dialog-popup">
        <a class="dialog-popup-close is-pulled-right">
            <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><style></style><path style="fill: red;" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"/></svg>
        </a>

        <!-- Dialog tabs -->
        <div class="tabs is-centered is-boxed is-small mb-0 pl-5">
            <ul class="dialog-tab-ul">
                <li data-target="dialog-template-tab" class="is-active">
                <a>
                    <span>Template</span>
                </a>
                </li>
                <li data-target="dialog-steps-tab">
                <a>
                    <span>TS steps</span>
                </a>
                </li>
                <li data-target="dialog-tips-tab">
                <a>
                    <span>Tips</span>
                </a>
                </li>
                <li data-target="dialog-help-tab">
                <a class="dialog-helper">
                    <span>Helper</span>
                </a>
                </li>
            </ul>
        </div>



        <!-- DIALOG CONTENT -->
        <div class="content dialog-template-divs">
            <div class="dialog-template-container" id="dialog-template-tab">
               
                <form class="message mb-3 is-small">
                    <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">Create new master Template:
                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/></svg>
                    </div>
                    <div class="message-body is-hidden">
                       <input type="text" class="input is-small" name="template-input" id="template-input" placeholder="Enter template name" required>
                       <button class="button mt-2 btn-submit-template is-small">Create</button>
                    </div>
                </form>


                 <form class="message is-small">
                    <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">Create ticket Template:
                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/></svg>
                    </div>
                    <div class="message-body is-hidden">
                        <div class="message is-danger is-small mt-2">
                            <div class="message-body p-2">
                                <ul>
                                    <li>Isama ang tag na @name / @domain / @number / @device this will update user's details in ticket textfield: example bellow</li>
                                    <li>Full name:  @name<br/>US Domain: @domain</li>
                                </ul>
                            </div>
                        </div>
                       <div  class="select is-fullwidth is-small">
                          <select class="select-option is-small dialog-select-option-create-ticket" required>
                             <option value="" disabled selected>-</option>
                              <option value="">-NO DATA-</option>
                           </select>
                         </div>
           
                            <input type="text" class="input mt-2 input-master-ticket input-ticket-title-child is-small" placeholder="Enter Ticket template name" id="ticket-template-name" required>
                            <textarea class="dialog-textarea-create-template-child mt-2 p-2" row="10" rows=10 required></textarea>
                       <button class="button btn-mt-2 btn-submit-new-child is-small">Save</button>
                    </div>
                </form>

               
               
               
                <div class="message is-warning">
                    <div class="menu dialog-menu-ul m-0 p-5">
                        <p class="menu-label m-0 p-0">
                          <span>NO DATA!</span>
                          <!--
                              <ul class="m-0 p-0">
                                <li><p>Dashboard</p></li>
                                <li><p>Customers</p></li>
                              </ul>
                           -->
                        </p>
                       
                       
                    </div>
                </div>


                <form class="message mb-3 is-small dialog-edit-form-master-ticket-container is-danger">
                    <div class="message-header is-clickable" onclick="resetEditForm(true)">EDIT Master Template:
                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/></svg>
                    </div>
                    <div class="message-body">
                        <input type="hidden" name="" class="dialog-edit-master-template-hidden">
                        <input type="text" class="input is-small dialog-edit-master-template-title" name="template-input" id="template-input" placeholder="Enter template name" required>
                        <button class="button mt-2 btn-submit-edit-master-template is-small is-primary">SAVE</button>
                        <div class="message is-warning is-small mt-2">
                            <div class="message-body p-2">
                                <ul>
                                    <li>You can only edit master ticket, deleting may cause error in the program</li>
                                   
                                </ul>
                            </div>
                        </div>
                    </div>
                </form>

                <form class="message mb-3 is-small dialog-edit-form-container is-danger is-hidden">
                    <div class="message-header is-clickable" onclick="resetEditForm(true)"> EDIT EXISTING TEMPLATE
                        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M201.4 342.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 274.7 86.6 137.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/></svg>
                    </div>
                    <div class="message-body dialog-edit-input-container">
                        <div class="message is-danger is-small mt-2">
                            <div class="message-body p-2">
                                <ul>
                                    <li>Isama ang tag na @name / @domain / @number / @device this will update user's details in ticket textfield: example bellow</li>
                                    <li>Full name:  @name<br/>US Domain: @domain</li>
                                </ul>
                            </div>
                        </div>
                             <input type="hidden" class="input mt-2 input-dialog-edit-hidden is-small" id="input-dialog-edit-hidden" required>
                             <input type="text" class="input mt-2 input-dialog-edit-title is-small" placeholder="Enter Ticket template name" id="input-dialog-edit-title" required>
                             <textarea class="textarea-dialog-edit-body mt-2 p-2" row="10" rows=10 required></textarea>
                        <button class="button btn-mt-2 btn-submit-edit is-small">Save</button>
                     </div>
                </form>




            </div>

<!-- STEPS -->
            <div class="dialog-steps-container is-hidden" id="dialog-steps-tab">
                <form class="message is-small">
                    <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">Create Troubleshooting steps
                    </div>
                    <div class="message-body">
                        <div class="message is-small is-danger">
                            <div class="message-body">
                                Add bullet style:<br />
                                alt+7 = (•)<br />
                                alt+16 = (►)
                            </div>
                        </div>
                        <textarea class="dialog-textarea-create-steps mt-0 p-2 has-text-weight-semibold" row="10" rows="5" required></textarea>
                       <button class="button btn-steps-create is-small">ADD</button>
                    </div>
                </form>


                 <div class="message is-warning p-0 m-0">
                    <div class="message-body p-0 m-0">
                        <div class="container troubleshooting-steps-container content hero p-0 m-0">
                            <div class="container steps-container dialog-steps-container-list hero-body p-0 m-0">
                                <p class="p-0 is-size-7 mb-1 ts-steps-list"><span>+</span>  <span>-NO DATA!-</span></p>

                               
                            </div>
                        </div>



                    </div>
                 </div>

            </div>


            <!-- TIPS -->
            <div class="dialog-tips-container is-hidden" id="dialog-tips-tab">
                <form class="message is-small">
                    <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">CREATE NEW TIPS
                    </div>
                    <div class="message-body">
                        <div class="message is-small is-danger">
                            <div class="message-body">
                                Keep title short as possible
                            </div>
                        </div>
                        <input type="text" class="input dialog-input-create-tips mb-2 is-small has-text-weight-semibold" placeholder="Enter Tips title" required>
                        <textarea class="dialog-textarea-create-tips mt-0 p-2 has-text-weight-semibold" row="10" rows="5" required></textarea>
                       <button class="button btn-steps-tips is-small is-primary">ADD</button>
                    </div>
                </form>

                <div class="container tips-data-container">
                    <div class="message is-warning is-small mb-1">
                        <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">VPN / Connectivity</div>
                        <div class="message-body is-hidden">
                            Lorem ipsum dolor sit amet consectetur adipisicing elit. Reprehenderit, aperiam.
                            Lorem ipsum dolor sit.
                            Lorem ipsum dolor sit, amet consectetur adipisicing elit. Mollitia minima dolore blanditiis qui.
                            lkjslkf
                            askl
                        </div>    
                    </div>

                 </div>

                 <form class="message is-small dialog-edit-tips-container is-danger mt-4 is-hidden">
                    <div class="message-header is-clickable" onclick="resetEditForm(true)">EDIT TIP
                    </div>
                    <div class="message-body">
                        <input type="hidden" name="" class="input-dialog-edit-tips-hidden">
                        <input type="text" class="input dialog-input-edit-tips-title mb-2 is-small has-text-weight-semibold" placeholder="Enter Tips title" required>
                        <textarea class="dialog-textarea-edit-tips-body full-textarea mt-0 p-2 is-size-7" row="10" rows="5" required></textarea>
                       <button class="button btn-steps-edit-tips is-small is-primary">UPDATE!</button>
                    </div>
                </form>



            </div>

            <!-- HELPER -->
            <div class="dialog-help-container is-hidden" id="dialog-help-tab">
                <form class="message is-small">
                    <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">CREATE NEW TIPS
                    </div>
                    <div class="message-body">
                        <div class="message is-small is-danger">
                            <div class="message-body">
                                Keep title short as possible
                            </div>
                        </div>
                        <input type="text" class="input dialog-input-create-tips mb-2 is-small has-text-weight-semibold" placeholder="Enter Tips title" required>
                        <textarea class="dialog-textarea-create-tips mt-0 p-2 has-text-weight-semibold" row="10" rows="5" required></textarea>
                       <button class="button btn-steps-tips is-small is-primary">ADD</button>
                    </div>
                </form>

                <div class="container tips-data-container">
                    <div class="message is-warning is-small mb-1">
                        <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">VPN / Connectivity</div>
                        <div class="message-body is-hidden">
                            Lorem ipsum dolor sit amet consectetur adipisicing elit. Reprehenderit, aperiam.
                            Lorem ipsum dolor sit.
                            Lorem ipsum dolor sit, amet consectetur adipisicing elit. Mollitia minima dolore blanditiis qui.
                            lkjslkf
                            askl
                        </div>    
                    </div>

                 </div>

                 <form class="message is-small dialog-edit-tips-container is-danger mt-4 is-hidden">
                    <div class="message-header is-clickable" onclick="resetEditForm(true)">EDIT TIP
                    </div>
                    <div class="message-body">
                        <input type="hidden" name="" class="input-dialog-edit-tips-hidden">
                        <input type="text" class="input dialog-input-edit-tips-title mb-2 is-small has-text-weight-semibold" placeholder="Enter Tips title" required>
                        <textarea class="dialog-textarea-edit-tips-body full-textarea mt-0 p-2 is-size-7" row="10" rows="5" required></textarea>
                       <button class="button btn-steps-edit-tips is-small is-primary">UPDATE!</button>
                    </div>
                    
                </form>
                <div class="message is-small is-danger">
                    <div class="message-body">
                        sadkfj
                    </div>
                </div>
            </div>

            <!-- END OF HELPER -->



        </div>


        <span class="tag is-size-6 is-success tag-success is-pulled-right">SUCCESSFULLY SAVED!!</span>
    </dialog>
   
   <!-- DIALOG SETTINGS -->
    <dialog class="dialog-settings">
        <a class="dialog-settings-close is-pulled-right">
            <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><style></style><path style="fill: red;" d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"/></svg>
        </a>

        <!-- DIALOG SETTINGS TABS -->
        <div class="tabs is-centered is-boxed is-small mb-0 pl-5">
            <ul class="dialog-settings-tab-ul">
                <li data-target="dialog-history-tab" class="is-active">
                <a>
                    <span>History</span>
                </a>
                </li>
                <li data-target="dialog-export-tab">
                <a>
                    <span>Export</span>
                </a>
                </li>
                <li data-target="dialog-import-tab">
                <a>
                    <span>Import</span>
                </a>
                </li>
                <li data-target="dialog-reset-tab">
                <a>
                    <span>Reset</span>
                </a>
                </li>
            </ul>
        </div>

        <!-- DIALOG SETTINGS CONTENT -->
        <div class="container dialog-settings-template-divs">
            <!-- History tab -->
            <div class="container" id="dialog-history-tab">
                <div class="message is-small">
                    <div class="message-header">HISTORY</div>
                    <div class="message-body p-1">
                        <textarea name="" id="textarea-dialog-settings-history" cols="30" rows="20" class="full-textarea p-1"></textarea>
                        <button class="button is-danger is-small is-pulled-right btn-dialog-settings-clear-history" onclick="btnClearHistory()">CLEAR</button>
                    </div>
                </div>
                <div class="message mt-3 is-danger is-small">
                    <div class="message-body">
                        <p>Saved History has limit, copy and paste this to your notepad to have a copy before clearing!</p>
                    </div>
		    <button class="button is-info is-small is-pulled-left btn-dialog-settings-clear-history" onclick="newTab()">OPEN IN NEW TAB</button>
                </div>
	
            </div>

            <!-- Export Tab -->
            <div class="container is-hidden" id="dialog-export-tab">
                <div class="message is-small">
                    <div class="message-header">Export template data</div>
                    <div class="message-body">
                        <textarea name="" cols="30" rows="10" class="full-textarea p-1 is-size-7" id="textarea-generate-backup" disabled></textarea>
                        <button class="button is-success is-small" id="btn-dialog-settings-generate-backup">GENERATE</button>
                        <button class="button is-warning is-small" onclick="copyGeneratedData()">Copy</button>
                    </div>
                </div>
                <div class="message is-danger is-small">
                    <div class="message-body">
                        <p>♦Click mo generate, tapos i save mo ung result sa kahit saan mo gusto i save (notepad)/ do not alter one text</p>
                        <p>♦kung sakali mag clear cache/data ka ng browser need mo i copy yan</p>
                        <p>♦para i import click mo naman un import tab > i paste mo dun ung result dito</p>
                    </div>
                </div>
            </div>

            <!-- Import Tab -->
            <div class="container is-hidden" id="dialog-import-tab">
               <div class="message is-warning is-small">
                   <div class="message-header">Import data</div>
                   <div class="message-body">
                        <div class="message is-danger is-small">
                            <div class="message-body">
                                <p>Copy and paste exported data/json string here</p>
                            </div>
                        </div>
                       <textarea name="" id="textarea-import-backup" cols="30" rows="10" class="full-textarea p-1 is-size-7"></textarea>
                       <button class="button is-danger is-small" id="btn-dialog-settings-import">IMPORT</button>
                   </div>
               </div>
               
            </div>

            <!-- Reset Tab -->
            <div class="container is-hidden" id="dialog-reset-tab">
                <div class="message is-danger is-small">
                    <div class="message-header">Import data</div>
                    <div class="message-body">
                         <div class="message is-warning is-small">
                             <div class="message-body">
                                 <p>Resetting app will remove all localStorage data</p>
                                 <p>All saved data/templates will be cleared!</p>
                                 <p>♦ Sure ka jn ah wala nng bawian yn hehe</p>
                             </div>
                         </div>
                        <button class="button is-danger is-large" onclick="resetApp()">RESET APP</button>
                    </div>
                </div>
               
             </div>




        </div>
       
    </div>

    </dialog>

    <script>
              //load
(function(){
    let localStorageData = JSON.parse(localStorage.getItem("template"));
    if(localStorageData){
        updateView(localStorageData);
        updateMainView(localStorageData);
//console.log(localStorageData.master_templates)
    }else{
        localStorage.setItem("template", JSON.stringify({
        "master_templates" : [],
        "templates" : [],
        "steps" : [],
        "tips" : []
    }));

    }
//saved data
    let localStorageSaved = JSON.parse(localStorage.getItem("history"));
    if(localStorageSaved){
        updateHistory(localStorageSaved);
    }else{
        localStorage.setItem("history", JSON.stringify({
            "history_data" :  []
        }))
    }

})();


//local data fetcher
function getLocalData(name){
    let rawd_data = localStorage.getItem(name),
    data = JSON.parse(rawd_data);
    return data;
}

function setLocalData(name, value){
    let data = JSON.stringify(value);
    localStorage.setItem(name, data);
}

//COPY FUNCTION
const inputCopyDomain = document.querySelector("#input-ticket-write-domain"),
inputCopyName = document.querySelector("#input-ticket-write-name"),
inputCopyNumber = document.querySelector("#input-ticket-write-number"),
inputCopyDevice = document.querySelector("#input-ticket-write-device"),
mainInputText = document.querySelector("#main-textarea-ticket");

const copyInputField = document.querySelectorAll(".copyable-input");
copyInputField.forEach(input => {
    input.addEventListener("dblclick", e => {
       
        navigator.clipboard.writeText(e.target.value);
        e.target.classList.add("bg-color");
        e.target.classList.add("is-success");
        setTimeout(() => e.target.classList.remove("bg-color"), 2000)
        setTimeout(() => e.target.classList.remove("is-success"), 2000)
    })
})






// ---------------SAVE FIelds
const btnSaveFields = document.querySelector(".btn-home-save-fields");
btnSaveFields.onclick = function(e){
    let data = getLocalData("history");//Check ID
    let datdat = Object.keys(data.history_data).map(key => data.history_data[key].history_id) || 1;
       
    // maximum code
    let datdatMax = datdat.length > 0 ? Math.max(...datdat) + 1 : 1;

    if(datdatMax >= 300){
        alert("MEMORY LIMIT REACHED! Clear saved Data or history!");
        return;
    }


    let hoursStr = new Date().toLocaleString([], {
  hour: '2-digit',
  minute: '2-digit'
});

    let dateToday = `${new Date().getMonth() + 1}/${ new Date().getDate() }/${ new Date().getFullYear() } - ${ hoursStr }`;    


     //get inputs
    const userId = document.querySelector("#input-ticket-write-domain"),
    userName = document.querySelector("#input-ticket-write-name"),
    userNumber = document.querySelector("#input-ticket-write-number"),
    userDevice = document.querySelector("#input-ticket-write-device"),
    textScript = document.querySelector("#script-main-ticket");

    if(!userId.value || !userName.value) {
        alert("Error: Empty Domain ID or Name")
        return;
    }
       


    let dataFormat = `__________________ ${ dateToday } _________________

US Domain:  ${ userId.value }
Full name:  ${ userName.value }
Contact:    ${ userNumber.value }
Device:     ${ userDevice.value }

${ textScript.value }


`;

   
   
    //to object format
    let newObject = {
        "history_id" : datdatMax,
        "history_body" : dataFormat
    }

    //insert to data
    data.history_data.push(newObject);

    //save to localStorage
    setLocalData("history", data);

    //update history field
    updateHistory(data);

}

function updateHistory(data){
    const textAreaHistory = document.querySelector("#textarea-dialog-settings-history");
    textAreaHistory.value = "";
   
    if(data.history_data.length > 0){
        data.history_data.forEach(item => {
            textAreaHistory.value += `${ item.history_body }`;
        })
    }
   
    //reset all fields
    resetAllFields();
}

function btnClearHistory(){
    if(confirm("Are you sure to delete History?")) {
        localStorage.setItem("history", JSON.stringify({
            "history_data" :  []
        }))
        const textAreaHistory = document.querySelector("#textarea-dialog-settings-history");
        textAreaHistory.value = "";
    };
}





//RESET ALL INPUT/TEXTAREA fields
const btnClearField = document.querySelector(".btn-clear-fields");
btnClearField.onclick = function(){
    const dialogMainContainer = document.querySelector(".dialog-main-container");
    dialogMainContainer.innerHTML = "";
    let newDiv = document.createElement("DIV");
    newDiv.setAttribute("class", "message is-danger");
    newDiv.innerHTML = `
    <div class="message-body">
        <p class="title">
            Sure na yan?
        </p>
        <p class="p-0 m-0 is-size-7">this will clear all fields, all unsaved text will be lost</p>
    </div>
    <button onclick="resetAllFields()" class="button is-primary is-small is-pulled-right">OO Naman</button>
    `;
    dialogMainContainer.appendChild(newDiv);
   
    dialogMain();
};
//remove this after
// dialogMain();

function resetAllFields(){
    const allInputs = document.querySelectorAll("input");
    allInputs.forEach(input => {
        if(input.type == "text" || input.type == "hidden"){
            input.value="";
        }
    })

    const textAreaHistory = document.querySelector("#textarea-dialog-settings-history");
    const allTextarea = document.querySelectorAll("textarea");
    allTextarea.forEach(text => {
        if(text.id == "textarea-dialog-settings-history") return;
        text.value = "";
    })

    //close dialog
    document.querySelector(".dialog-main").close();
}



// ____________ADD DETAILS
const btnAddDetails = document.querySelector(".btn-add-details");
btnAddDetails.onclick = function(e){
    const userId = document.querySelector("#input-ticket-write-domain"),
    userName = document.querySelector("#input-ticket-write-name"),
    userNumber = document.querySelector("#input-ticket-write-number"),
    userDevice = document.querySelector("#input-ticket-write-device"),
    mainTicket = document.querySelector("#main-textarea-ticket"),
    pinName = document.querySelector("#input-ticket-pin-name"),
    pinNumber = document.querySelector("#input-ticket-pin-number"),
    pinPassword = document.querySelector("#input-ticket-pin-password"),
    pinManager = document.querySelector("#input-ticket-pin-manager"),
    textScript = document.querySelector("#script-main-ticket");

    if(mainTicket.value){
        // console.log(typeof mainTicket.value)
        if(userId.value) mainTicket.value = mainTicket.value.replace("@domain", userId.value);
        if(userName.value) mainTicket.value = mainTicket.value.replace("@name", userName.value);
        if(userNumber.value) mainTicket.value = mainTicket.value.replace("@number", userNumber.value);
        if(userDevice.value) mainTicket.value = mainTicket.value.replace("@device", userDevice.value);
        // let newValue = mainTicket.value.replace("%namse%", userName.value);
        //PIN FAILURE
        if(pinName.value){
            mainTicket.value = mainTicket.value.replace("@pinName", pinName.value);
            textScript.value = textScript.value.replace("@pinName", pinName.value);
        };
        if(pinNumber.value) mainTicket.value = mainTicket.value.replace("@pinNumber", pinNumber.value);
        if(pinPassword.value) mainTicket.value = mainTicket.value.replace("@pinPassword", `${ pinPassword.value }`);
        if(pinManager.value) mainTicket.value = mainTicket.value.replace("@pinManager", pinManager.value);
       
    }
}

















// ___________UPDATE HOME TICKET

function updateMainView(data){
    //console.log(data)
    //template view
    displayHomeTemplate(data);

    //display Steps list
    displayHomeSteps(data);

    //Display tips list
    displayHomeTips(data);
}


// Home Tips
function displayHomeTips(data){
    const homeTipsContainer = document.querySelector(".home-tips-container");
    homeTipsContainer.innerHTML = "";
    if(data.tips.length > 0){
        data.tips.forEach(tip => {
            let newBtn = document.createElement("BUTTON");
            newBtn.setAttribute("class", "button is-small is-fullwidth is-warning mb-1");
            newBtn.setAttribute("onclick", "selectedTips(this)");
            newBtn.setAttribute("data-value", `${ tip.tip_body }`);
            newBtn.innerHTML = `${ tip.tip_title }`;
            homeTipsContainer.appendChild(newBtn);
        })
    }
}
function selectedTips(e){
    const textArea = document.querySelector("#home-tips-textarea");
    textArea.value = e.dataset.value;
    //console.log(e.dataset.value)
}





//Home steps
function displayHomeSteps(data){
    const homeStepsContainer = document.querySelector(".steps-container");
    homeStepsContainer.innerHTML = "";
    //populate
    if(data.steps.length > 0){
        data.steps.forEach(step => {
            let newP = document.createElement("P");
            newP.setAttribute("class", "p-0 is-size-7 mb-1 ts-steps-list pl-3");
            newP.setAttribute("data-value", `${ step.step_title }`);
            newP.setAttribute("onclick", "selectedSteps(this)");
            newP.innerHTML = `<span class="has-text-danger">♦</span>  <span>${ step.step_title }</span>`;
            homeStepsContainer.appendChild(newP);
        })
    }
}

function selectedSteps(e){
    const textArea = document.querySelector("#main-textarea-ticket");
    textArea.value += `\n${ e.dataset.value }`;
}


//Home template
function displayHomeTemplate(data){
    const homeTemplateContainer = document.querySelector(".home-select-template-container");
    homeTemplateContainer.innerHTML = `<p class="title is-size-7 mb-1">Select Template</p>`;
   
    if(data.master_templates.length > 0){
        data.master_templates.forEach(temp => {
            let newDiv = document.createElement("DIV");
            newDiv.setAttribute("class", "container ticket-select-container");

            //map li
            let templateListItems = data.templates.map(template => {
                if (template.master_code === temp.master_code) {
                    return `
                        <li class="pl-4">
                            <label class="radio is-size-7 has-text-weight-semibold">
                                <input type="radio" onclick="selectedTemplate(this)" name="ticket-template" id="${template.ticket_code}" data-value="${ template.ticket_body }">
                                ${template.ticket_title}
                            </label>
                        </li>
                    `;
                }
                return ''; // Return an empty string for templates that don't match
            })

            newDiv.innerHTML = `
                <button onclick="templateSelect(this)" class="button is-small is-fullwidth is-warning is-light mb-1">${ temp.master_title }</button>
                <span class="tab-items-span is-hidden">
                    <ul>
                        ${ templateListItems.join('') }
                    </ul>
                </span>  
            `;
            homeTemplateContainer.appendChild(newDiv);

        })

        //create Pin failure div container
        let pinDiv = document.createElement("DIV");
        pinDiv.setAttribute("class", "container ticket-select-container");
        pinDiv.innerHTML = `
                <button onclick="templateSelect(this)" class="button is-small is-fullwidth is-warning is-light mb-1">PIN Verification Failure</button>
                <span class="tab-items-span is-hidden">
                    <ul>
                        <li class="pl-4">
                            <label class="radio is-size-7 has-text-weight-semibold">
                                <input onclick="templatePinSelected(1)" type="radio" name="ticket-template" id="">
                                Password reset PIN Failure
                            </label>
                        </li>
                        <li class="pl-4">
                            <label class="radio is-size-7 has-text-weight-semibold">
                                <input onclick="templatePinSelected(2)" type="radio" name="ticket-template" id="">
                                Account Unlock PIN Failure
                            </label>
                        </li>
                    </ul>
                </span>
        `;

        //append new child
        homeTemplateContainer.appendChild(pinDiv);
    }
}



function selectedTemplate(e){
    //change input groups
    switchToPinFailure(false);
    //document.querySelector("#script-main-ticket").value = "";
    const textArea = document.querySelector("#main-textarea-ticket");
    textArea.value = e.dataset.value;
    textArea.focus();
       
}

function templatePinSelected(e){
    switchToPinFailure(true);
    const textArea = document.querySelector("#main-textarea-ticket"),
    textScript = document.querySelector("#script-main-ticket");
    textScript.value = "";

    //String message body
   
    let resetPin = `
Hi @pinManager,

Your associate @pinName called the IT Enterprise Service Desk for a Password Reset today however we were unsuccessful with the reset due to the associate not knowing their PIN.

We have provided their PIN and a temporary password below to be used to login to the system. Please remind your associate once they have logged in to visit My IT Profile (https://myprofile.elevancehealth.com ) to change their password. They can also change their PIN to something they will remember for future interactions with the service desk.

 

Temporary Password (case sensitive) - @pinPassword

PIN -  @pinNumber

By providing the temporary password and PIN number, this allows the associate to get logged in without having to call the service desk a second time.

For reference, here are My IT Profile video tutorials and guides to complete registration and use My IT Profile for password resets.

 

If you have any questions about this process, please contact the IT Enterprise Service Desk at 1-888-268-4368.

 

Thank You,

Jomari Dizon
IT Enterprise Service Desk
1-888-268-4368

`;

    let unlockPin = `
Hi @pinManager,

The IT Enterprise Service Desk was contacted by your reporting associate, @pinName , to have their [US domain/account] unlocked. However, they were unable to provide the required security PIN to authorize this request. 

Per Anthem security protocol, the next step in gaining access is to email the PIN to the user's manager so they may provide it to the associate. Once the PIN is received, the user may contact the Service Desk to request account unlock.

The PIN number is @pinNumber.

 

If you have any questions about this process, please contact the IT Enterprise Service Desk at 1-888-268-4368.

 

Thank You,

Jomari Dizon
IT Enterprise Service Desk
1-888-268-4368`;

    let emailTitle = `
IT Enterprise Service Desk - PIN Verification Failure for @pinName
    `;


   
    switch(e){
        case 1:
            textArea.value = resetPin;
            break;
        case 2:
            textArea.value = unlockPin;
            break;
        default:
            console.log("ERROR!")
    }

    textScript.value += `\nEmail Subject:${ emailTitle }`;

    textArea.focus();
}


function switchToPinFailure(bool){
    if(bool){
        document.querySelector(".input-group-pin-failure").classList.remove("is-hidden");
        document.querySelector(".input-group-general").classList.add("is-hidden");
    }
    if(!bool){
        document.querySelector(".input-group-pin-failure").classList.add("is-hidden");
        document.querySelector(".input-group-general").classList.remove("is-hidden");
    }
}




























//_______________HOME TICKET END




// ***********************************EDIT!

//******FOR TIPS */

const btnEditTips = document.querySelector(".btn-steps-edit-tips");
btnEditTips.onclick = function(e){
    e.preventDefault();
   
    //get local data
    let data = getLocalData("template");
    //get elemets
    const editForm = document.querySelector(".dialog-edit-tips-container"),
    inputTitle = document.querySelector(".dialog-input-edit-tips-title"),
    inputBody = document.querySelector(".dialog-textarea-edit-tips-body"),
    inputHidden = document.querySelector(".input-dialog-edit-tips-hidden");

    if(Number(inputHidden.value) > 0){
        if(!inputTitle.value){
            inputTitle.classList.add("has-background-danger-light");
            setTimeout(() => inputTitle.classList.remove("has-background-danger-light"), 5000)
            successTag(false, "Title is empty!!!!!!!")
            inputTitle.focus();
            return;
        }

        if(!inputBody.value){
            inputBody.classList.add("has-background-danger-light");
            setTimeout(() => inputBody.classList.remove("has-background-danger-light"), 5000)
            successTag(false, "Body is empty!!!!!!!")
            inputBody.focus();
            return;
        }

        //confirm
         if(!confirm("Are you sure you wan't to edit?")) return;


        data.tips.forEach(template => {
            if(template.tip_code == Number(inputHidden.value)){
                template.tip_title = inputTitle.value;
                template.tip_body = inputBody.value;
            }
        })

        //save new data to local data
        setLocalData("template", data);

        //Update view
        updateView(data);
    }



}



function dialogOpenEditTipsTemplate(e){
    let data = getLocalData("template");
    let dataTarget = e.dataset.target;
   
    const editForm = document.querySelector(".dialog-edit-tips-container"),
    inputTitle = document.querySelector(".dialog-input-edit-tips-title"),
    inputBody = document.querySelector(".dialog-textarea-edit-tips-body"),
    inputHidden = document.querySelector(".input-dialog-edit-tips-hidden");

    if(data){

        data.tips.forEach(template => {
            if(template.tip_code == Number(dataTarget)){
                inputTitle.value = template.tip_title;
                inputBody.value = template.tip_body;
                inputHidden.value = template.tip_code;
            }
        })
        editForm.classList.remove("is-hidden");
        inputTitle.focus()
    }
}











//For Master template
const btnSubmitEditMt = document.querySelector(".btn-submit-edit-master-template");
btnSubmitEditMt.onclick = function(e){
    e.preventDefault();
    if(!confirm("Are you sure you wan't to edit?")) return;
   
    //get local data
    let data = getLocalData("template");
    // get input data
    const inputHiddenMt = document.querySelector(".dialog-edit-master-template-hidden"),
    inputTitleMt = document.querySelector(".dialog-edit-master-template-title");

    if(Number(inputHiddenMt.value) > 0){
        if(!inputTitleMt.value){
            inputTitleMt.classList.add("has-background-danger-light");
            setTimeout(() => inputTitleMt.classList.remove("has-background-danger-light"), 5000)
            successTag(false, "Title is empty!!!!!!!")
            inputTitleMt.focus();
            return;
        }


        data.master_templates.forEach(template => {
            if(template.master_code == Number(inputHiddenMt.value)){
                template.master_title = inputTitleMt.value;
            }
        })

        //save new data to local data
        setLocalData("template", data);

        //Update view
        updateView(data);
    }

}


function dialogOpenEditMasterTemplate(e){
    let data = getLocalData("template");
    let dataTarget = e.dataset.target;
    //get all elements
    const dialogFormMasterTicketContainer = document.querySelector(".dialog-edit-form-master-ticket-container");
    dialogFormMasterTicketContainer.classList.remove("is-hidden");
    const inputHiddenMt = document.querySelector(".dialog-edit-master-template-hidden"),
    inputTitleMt = document.querySelector(".dialog-edit-master-template-title");

    if(data){

        data.master_templates.forEach(template => {
            if(template.master_code == Number(dataTarget)){
                inputTitleMt.value = template.master_title;
                inputHiddenMt.value = template.master_code;
            }
        })
        inputTitleMt.focus()
    }


}










//For child template

const btnEditTemplate = document.querySelector(".btn-submit-edit");
btnEditTemplate.onclick = function(e){
    e.preventDefault();
    if(!confirm("Are you sure?")) return;
    //get local data
    let data = getLocalData("template");
    // get input data
    const inputTitle = document.querySelector(".input-dialog-edit-title"),
    inputBody = document.querySelector(".textarea-dialog-edit-body"),
    inputHidden = document.querySelector(".input-dialog-edit-hidden");
    //log
    if(Number(inputHidden.value) > 0){
        if(!inputTitle.value){
            inputTitle.classList.add("has-background-danger-light");
            setTimeout(() => inputTitle.classList.remove("has-background-danger-light"), 5000)
            successTag(false, "Title is empty!!!!!!!")
            inputTitle.focus();
            return;
        }

        if(!inputBody.value){
            inputBody.classList.add("has-background-danger-light");
            setTimeout(() => inputBody.classList.remove("has-background-danger-light"), 5000)
            successTag(false, "Description is empty!!!!!!!")
            inputBody.focus();
            return;
        }

        data.templates.forEach(template => {
            if(template.ticket_code == Number(inputHidden.value)){
                template.ticket_title = inputTitle.value;
                template.ticket_body = inputBody.value;
            }
        })

        //save new data to local data
        setLocalData("template", data);

        //Update view
        updateView(data);
    }
}

function dialogOpenEditTemplate(e){
    let data = getLocalData("template");
    let dataTarget = e.dataset.target;
   
    const editForm = document.querySelector(".dialog-edit-form-container"),
    editInputs = document.querySelector(".dialog-edit-input-container"),
    inputTitle = document.querySelector(".input-dialog-edit-title"),
    inputBody = document.querySelector(".textarea-dialog-edit-body"),
    inputHidden = document.querySelector(".input-dialog-edit-hidden");

    if(data){

        data.templates.forEach(template => {
            if(template.ticket_code == Number(dataTarget)){
                inputTitle.value = template.ticket_title;
                inputBody.value = template.ticket_body;
                inputHidden.value = template.ticket_code;
            }
        })
        editForm.classList.remove("is-hidden");
        editInputs.classList.remove("is-hidden");
        inputTitle.focus()
    }

}


function resetEditForm(bool){
    if(bool){
        document.querySelector(".dialog-edit-form-master-ticket-container").classList.add("is-hidden");
        document.querySelector(".dialog-edit-master-template-hidden").value = "";
        document.querySelector(".dialog-edit-master-template-title").value = "";

        const editForm = document.querySelector(".dialog-edit-form-container"),
        editInputs = document.querySelector(".dialog-edit-input-container"),
        inputTitle = document.querySelector(".input-dialog-edit-title"),
        inputBody = document.querySelector(".textarea-dialog-edit-body"),
        inputHidden = document.querySelector(".input-dialog-edit-hidden");
        editForm.classList.add("is-hidden");
        editInputs.classList.add("is-hidden");
        inputTitle.value = "";
        inputBody.value = "";
        inputHidden.value = "";

        //For Tips
        document.querySelector(".dialog-edit-tips-container").classList.add("is-hidden");
        document.querySelector(".dialog-input-edit-tips-title").value = "";
        document.querySelector(".dialog-textarea-edit-tips-body").value = "";
        document.querySelector(".input-dialog-edit-tips-hidden").value = "";

    }
}






//Create master template
//CREATE MASTER TEMPLATE

//add master template
const btnCreateMt = document.querySelector(".btn-submit-template");
const inputCreateMt = document.querySelector("#template-input");
btnCreateMt.onclick = function(e) {
    e.preventDefault();
    //check if empty
    if(!inputCreateMt.value) {
        emptyInputError(inputCreateMt, "Text is empty!");
        return;
    }
    if(!confirm("Are you sure?")) return;
   
    const data = getLocalData("template") || [];

       
    if(data){
        let datdat = Object.keys(data.master_templates).map(key => data.master_templates[key].master_code) || 1;
        
        let datdatMax = datdat.length > 0 ? Math.max(...datdat) + 1 : 1;

        // create object
        let newMasterTemp = {
            master_code : datdatMax,
            master_title : inputCreateMt.value
        }
       
        data.master_templates.push(newMasterTemp);
        
        setLocalData("template", data);


    updateView(data);

    // Clear field
    inputCreateMt.value = "";
    inputCreateMt.focus();

    //add effect
    successTag(true,"NEW MASTER TEMPLATE ADDED!");
    }
   
}


// ADD NEW CHILD TICKET
const btnCreateTicket = document.querySelector(".btn-submit-new-child");
btnCreateTicket.onclick = function(e){
    e.preventDefault();

    const selectOpt = document.querySelector(".dialog-select-option-create-ticket"),
    inputTitle = document.querySelector(".input-ticket-title-child"),
    textareaTicket = document.querySelector(".dialog-textarea-create-template-child");
    //check if empty
    if(!selectOpt.value) {
        emptyInputError(selectOpt, "Text is empty!");
        return;
    }
    if(!inputTitle.value) {
        emptyInputError(inputTitle, "Text is empty!");
        return;
    }
    if(!textareaTicket.value) {
        emptyInputError(textareaTicket, "Text is empty!");
        return;
    }

    //confirm
    if(!confirm("Are you sure?")) return;
   
    //GET JSON data
    let data = JSON.parse(localStorage.getItem("template"));
    //get value
    if(data){
        let datdat = Object.keys(data.templates).map(key => data.templates[key].ticket_code) || 1;
       
        // maximum code
        let datdatMax = datdat.length > 0 ? Math.max(...datdat) + 1 : 1;

        let masterCode = Number(selectOpt.value);
        let ticketTitle = inputTitle.value;
        let ticketBody = textareaTicket.value;
   
        let objTicket = {
            ticket_code : datdatMax,
            master_code : masterCode,
            ticket_title : ticketTitle,
            ticket_head : "",
            ticket_body : ticketBody
        }
   
   
        //insert new object to template array
        data.templates.push(objTicket);
       
        //save back to localStorage
        localStorage.setItem("template", JSON.stringify(data));
       
        updateView(data);
        //reset fields
        inputTitle.value = "";
        textareaTicket.value = "";
        selectOpt[0].selected = "selected";
        successTag(true, "Successfully created ticket!")
    }
}


//Create new TS steps
const btnSaveSteps = document.querySelector(".btn-steps-create");
btnSaveSteps.onclick = function(e){
    e.preventDefault();
    const stepsText = document.querySelector(".dialog-textarea-create-steps");
    //Check if empty
    if(!stepsText.value) {
        emptyInputError(stepsText, "Text is empty!");
        return;
    }
    //Confirm
    if(!confirm("Are you sure?")) return;
   

    //getData
    const data = getLocalData("template");

    if(data){
        let datdat = Object.keys(data.steps).map(key => data.steps[key].step_code) || 1;
       
        // maximum code
        let datdatMax = datdat.length > 0 ? Math.max(...datdat) + 1 : 1;
       
        // create object
        let newStepObject = {
            step_code : datdatMax,
            step_title : stepsText.value
        }


        //Push to data
        data.steps.push(newStepObject);

       
        //add to local data
        setLocalData("template", data)
       
        //Finally UpdateTicketDisplay
        updateView(data);

        // Clear field
        stepsText.value = "";
        stepsText.focus();

        //add effect
        successTag(true, "NEW TS Step is added!");

     
   
    }

}


//Create new TIPS
const btnCreateTips = document.querySelector(".btn-steps-tips");
btnCreateTips.onclick = function(e){
    e.preventDefault();
    const inputTipTitle = document.querySelector(".dialog-input-create-tips"),
    inputTipBody = document.querySelector(".dialog-textarea-create-tips");
   
    //check if empty
    if(!inputTipTitle.value) {
        emptyInputError(inputTipTitle, "Text is empty!");
        return;
    }
    if(!inputTipBody.value) {
        emptyInputError(inputTipBody, "Text is empty!");
        return;
    }
   
    //cofirm
    if(!confirm("Are you sure?")) return;

    //get Local data
    let data = getLocalData("template");
    if(data){
        let datdat = Object.keys(data.tips).map(key => data.tips[key].tip_code) || 1;
       
        // maximum code
        let datdatMax = datdat.length > 0 ? Math.max(...datdat) + 1 : 1;

        //create tip object
        let newTipObj = {
            tip_code : datdatMax,
            tip_title : inputTipTitle.value,
            tip_body : inputTipBody.value
        }
        //add object to array
        data.tips.push(newTipObj);
       
        //insert new object to tips local storage
        setLocalData("template", data);

        // reset input
        inputTipBody.value = "";
        inputTipTitle.value = "";
        inputTipTitle.focus();

        //show success effect
        successTag(true,"New TIP added successfully!");
       
        //updateView
        updateView(data);
        //console.log(data)
    }
}




//*****************UPDATE VIEW

function updateView(data){
    if(data){


        //Update Dialog Ticket UL
        updateDialogTicketUl(data);

        // Update dialog steps
        updateDialogSteps(data);

        //Update dialog tips
        updateDialogTips(data);
       

        //Update Select option in create ticket template
        updateDialogSelect(data);
       
        //reset edit form
        resetEditForm(true);

        //Update main view
        updateMainView(data);
    }
}


function updateDialogTips(data){
    const dialogTipsContainer = document.querySelector(".tips-data-container");
    if(data.tips.length > 0){
        dialogTipsContainer.innerHTML = "";
        data.tips.forEach(tip => {
            const newDiv = document.createElement("DIV");
            newDiv.setAttribute("class", "message is-warning is-small mb-1");
            newDiv.setAttribute("data-target", `${ data.tip_code }`)
            newDiv.innerHTML = `
            <div class="message-header is-clickable" onclick="dialogTemplateDraw(this)">
            <span>
           
            <svg onclick="dialogOpenEditTipsTemplate(this)" data-target="${ tip.tip_code }" class="is-clickable" xmlns="http://www.w3.org/2000/svg" class="is-clickable" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path style="fill: red" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
            </span>
            ${ tip.tip_title }
            <svg onclick="removeTipTemplates(this)" data-target="${ tip.tip_code }" class="is-pulled-right is-clickable" xmlns="http://www.w3.org/2000/svg" height=".9em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path style="fill: red" d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg>
            </div>
            <div class="message-body is-hidden enable-line-break">${ tip.tip_body }</div>  
            `;
            dialogTipsContainer.appendChild(newDiv);
        })
    }
}


function updateDialogSteps(data){
    const dialogStepsContainer = document.querySelector(".dialog-steps-container-list");
    if(data.steps.length > 0){
        dialogStepsContainer.innerHTML = "";
        data.steps.forEach(step => {
            const newP = document.createElement("P");
            newP.setAttribute("class", "p-0 is-size-7 mb-1 ts-steps-list")
            newP.setAttribute("data-target",`${ step.step_code}`)
            newP.innerHTML = `
            <span>+</span>  <span>${ step.step_title }
            <svg onclick="removeStepTemplate(this)" data-target="${ step.step_code }" class="is-pulled-right is-clickable" xmlns="http://www.w3.org/2000/svg" height=".9em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path style="fill: red" d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg>
                       
            </span>
            `;
            dialogStepsContainer.appendChild(newP)

        })
    }
}

function updateDialogTicketUl(data){
    const dialogTemplateUl = document.querySelector(".dialog-menu-ul");
    if(data.master_templates.length > 0){
        dialogTemplateUl.innerHTML = "";
        data.master_templates.forEach(temp => {
            const newP = document.createElement("P");
            newP.setAttribute("class", "menu-label m-0 p-0 has-text-weight-semibold")
            newP.setAttribute("data-target", `${temp.master_code}`);
            newP.innerHTML = `<span>${ temp.master_title }</span>
            <svg onclick="dialogOpenEditMasterTemplate(this)" data-target="${ temp.master_code }" class="is-pulled-right is-clickable" xmlns="http://www.w3.org/2000/svg" class="is-clickable" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path style="fill: rgb(254, 93, 93)" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>`;
            dialogTemplateUl.appendChild(newP);
           
            if(data.templates.length > 0){
                let newUl = document.createElement("UL");
                newUl.setAttribute("class", "m-0 p-0");
                data.templates.forEach(template => {
                    if(Number(newP.dataset.target) == template.master_code){
                        let newLi = document.createElement("LI");
                        newLi.innerHTML = `<p class="remove-ts-data-btn">
                            <span><svg onclick="dialogOpenEditTemplate(this)" data-target="${ template.ticket_code }" xmlns="http://www.w3.org/2000/svg" class="is-clickable" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path style="fill: rgb(254, 93, 93)" d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span>
                            • ${ template.ticket_title }
                            <svg onclick="removeTicketTemplate(this)" data-target="${ template.ticket_code }" class="is-pulled-right is-clickable" xmlns="http://www.w3.org/2000/svg" height=".9em" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path style="fill: red" d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg>
                        </p>
                        `;
                        newUl.appendChild(newLi);
                       
                    }
                })

                newP.after(newUl);
            }
           
        })
        //console.log(data.master_templates.length)
    }
}


// Update dialog select field
function updateDialogSelect(data){
    const selectOption = document.querySelector(".dialog-select-option-create-ticket");
        selectOption.innerHTML = `<option value="" disabled selected>-</option>`;
        data.master_templates.forEach(templ => {
            let newOpt = document.createElement("OPTION");
            newOpt.innerHTML = `<option value="${ templ.master_code }">${ templ.master_title }</option>`
            newOpt.value=templ.master_code;
            selectOption.appendChild(newOpt);
        })
}







// ***********REMOVE



//remove Tips
function removeTipTemplates(e){
    if(!confirm("Are you sure to remove this step?")) return;
    let data = getLocalData("template");
    const targetId = e.dataset.target;
    let newData = data.tips.filter(tip => {
        if(tip.tip_code != Number(targetId)){
            return true;
        }
    })
    data.tips = newData;

    //dave data to localStorage
    setLocalData("template", data);
    //refresh view
    updateView(data);
   
}



//remove Steps
function removeStepTemplate(e){
    if(!confirm("Are you sure to remove this step?")) return;
    let data = getLocalData("template");
    const targetId = e.dataset.target;
    let newData = data.steps.filter(step => {
        if(step.step_code != Number(targetId)){
            return true;
        }
    })
    data.steps = newData;

    //dave data to localStorage
    setLocalData("template", data);
    //refresh view
    updateView(data);
    //tag
    successTag(true, "Removed successfully!")
   
}


//remove template
function removeTicketTemplate(e){
    if(!confirm("Are you sure to remove this template?")) return;
    let data = getLocalData("template");
    const targetId = e.dataset.target;
    let newData = data.templates.filter(temp => {
        if(temp.ticket_code != Number(targetId)){
            return true;
        }
    })
    data.templates = newData;

    //dave data to localStorage
    setLocalData("template", data);
    //refresh view
    updateView(data);
   
}




//EFFECTS
function successTag(bool, msg){
    const tagElem = document.querySelector(".tag-success");
    tagElem.focus();

    if(bool){
            tagElem.classList.remove("is-danger");
            tagElem.innerHTML = msg || "SUCCESS!";
            tagElem.classList.add("tag-show");
            setTimeout(() => {
                tagElem.classList.remove("tag-show");
            }, 2000)
    }

    if(!bool){
        tagElem.classList.add("is-danger");
        tagElem.innerHTML = msg || "FAILED!";
        tagElem.classList.add("tag-show");
        setTimeout(() => {
            tagElem.classList.remove("tag-show");
        }, 5000)
    }
}




















function templateSelect(e){
    //console.log(e.nextElementSibling);
    e.nextElementSibling.classList.toggle("is-hidden");
}


// UL select templates TABS
const templateTabs = document.querySelectorAll(".select-steps-ul > li");

templateTabs.forEach(templateTab => {
    templateTab.onclick = function(){
        const tabTarget = templateTab.dataset.target;
        // console.log(templateTab.dataset.target)
        // loop tabdiv and hide
        templateTabs.forEach(tab => tab.classList.remove("is-active"));
        document.querySelectorAll(".tab-home > div").forEach(div => {
            div.classList.add("is-hidden");
        })

        //loop div remove id-hidden
        templateTab.classList.add("is-active");
        document.querySelectorAll(".tab-home > div").forEach(div => {
            if(div.id === tabTarget){
                div.classList.remove("is-hidden");
            }
        })
    }

})




// **********DIALOG

function dialogSettings(){
    const dialogElem = document.querySelector(".dialog-settings");
    dialogElem.showModal();


    document.querySelector(".dialog-settings-close").addEventListener("click", f => {
        dialogElem.close();
    })


}


function dialogPop(){
    const dialogElem = document.querySelector(".dialog-popup");
    dialogElem.showModal();


    document.querySelector(".dialog-popup-close").addEventListener("click", f => {
        dialogElem.close();
    })


}

function dialogMain(){
    const dialogElem = document.querySelector(".dialog-main");
    dialogElem.showModal();


    document.querySelector(".btn-dialog-main-no").addEventListener("click", f => {
        dialogElem.close();
        document.querySelector(".dialog-main-container").innerHTML = "";
    })
}





function dialogTemplateDraw(e){
    e.nextElementSibling.classList.toggle("is-hidden");
}


function emptyInputError(elem, msg){
        elem.classList.add("has-background-danger-light");
        setTimeout(() => elem.classList.remove("has-background-danger-light"), 5000)
        successTag(false, msg);
        elem.focus();
        return;
}


// Dialog tab
const btnDialogTabs = document.querySelectorAll(".dialog-tab-ul > li");
btnDialogTabs.forEach(btnDialogTab => {
    btnDialogTab.onclick = function(e){
        const dialogTab = btnDialogTab.dataset.target;
        //tabs active
        btnDialogTabs.forEach(btnTab => btnTab.classList.remove("is-active"));
   
        //Tabs add active
        btnDialogTab.classList.add("is-active");

        //add is-hidden to all divs
        document.querySelectorAll(".dialog-template-divs > div").forEach(dialogDiv => dialogDiv.classList.add("is-hidden"));
       
        //remove is-hidden to a div to show
        document.querySelectorAll(".dialog-template-divs > div").forEach(dialogDiv => {
            if(dialogDiv.id === dialogTab){
                dialogDiv.classList.remove("is-hidden");
            }
        });
       
    }
   
})




// Dialog Settings tab
const btnDialogSettingsTabs = document.querySelectorAll(".dialog-settings-tab-ul > li");
btnDialogSettingsTabs.forEach(btnDialogTab => {
    btnDialogTab.onclick = function(e){
        const dialogTab = btnDialogTab.dataset.target;
        //tabs active
        btnDialogSettingsTabs.forEach(btnTab => btnTab.classList.remove("is-active"));
   
        //Tabs add active
        btnDialogTab.classList.add("is-active");

        //add is-hidden to all divs
        document.querySelectorAll(".dialog-settings-template-divs > div").forEach(dialogDiv => dialogDiv.classList.add("is-hidden"));
       
        //remove is-hidden to a div to show
        document.querySelectorAll(".dialog-settings-template-divs > div").forEach(dialogDiv => {
            if(dialogDiv.id === dialogTab){
                dialogDiv.classList.remove("is-hidden");
            }
        });
       
    }
   
})



// Helper tabs
const btnHelperTabs = document.querySelectorAll(".helper-tab-ul > li");
btnHelperTabs.forEach(btnHelperTab => {
    btnHelperTab.onclick = function(e){
        const dialogTab = btnHelperTab.dataset.target;
        //tabs active
        btnHelperTabs.forEach(btnTab => btnTab.classList.remove("is-active"));
   
        //Tabs add active
        btnHelperTab.classList.add("is-active");

        //add is-hidden to all divs
        document.querySelectorAll(".helper-container-divs > div").forEach(dialogDiv => dialogDiv.classList.add("is-hidden"));
       
        //remove is-hidden to a div to show
        document.querySelectorAll(".helper-container-divs > div").forEach(dialogDiv => {
            if(dialogDiv.id === dialogTab){
                dialogDiv.classList.remove("is-hidden");
            }
        });
       
    }
   
})

















//for ts dialog settings
//dialogSettings();


// IMPORT backup data
const btnImportData = document.querySelector("#btn-dialog-settings-import");
btnImportData.onclick = function(e){
    const textAreaData = document.querySelector("#textarea-import-backup");
    if(!textAreaData.value){
        alert("WALANG LAMAN !!!");
        textAreaData.focus();
        return;
    }

    try{
        JSON.parse(textAreaData.value);
    }catch (e){
        alert("INVALID DATA!")
        return;
    }

    //set to local data
    localStorage.setItem("template", textAreaData.value);
    //Update view
    let data = getLocalData("template");
    updateView(data);
    updateMainView(data);
    //console.log(JSON.parse(textAreaData.value).master_template)
    resetAllFields();
}


//Generate backup data
const btnGenerateBackup = document.querySelector("#btn-dialog-settings-generate-backup");
btnGenerateBackup.onclick = function(e){
    let data = getLocalData("template");
    const textArea = document.querySelector("#textarea-generate-backup");
    textArea.value = JSON.stringify(data);
}

function copyGeneratedData(){
    const textArea = document.querySelector("#textarea-generate-backup");
    if(!textArea.value) {
        alert("HOY CLICK MO MUNA GENERATE!!!!!!!!!!!!")
        return;
    };
    navigator.clipboard.writeText(textArea.value);
    textArea.classList.add("bg-color");
    textArea.classList.add("is-success");
    setTimeout(() => textArea.classList.remove("bg-color"), 2000)
    setTimeout(() => textArea.classList.remove("is-success"), 2000)
}

function resetApp(){
    if(confirm("ARE YOU SURE????!!!! \nThis will remove all your saved data and template bruhhhh!")){
        if(confirm("di nga seryoso?")){
            localStorage.setItem("template", JSON.stringify({
                "master_templates" : [],
                "templates" : [],
                "steps" : [],
                "tips" : []
            }));
            localStorage.setItem("history", JSON.stringify({
                "history_data" :  []
            }))
            location.reload();
        }
    }
}

function newTab(){
  window.open(window.location.href,"window","toolbar=no, location=no, menubar=no, resizable=yes, width=460, height=530");
  //if(confirm("CLOSE THIS WINDOW?")) window.close();
}

console.log('window.open(url,"window","toolbar=no, menubar=no, resizable=yes")');
 

// HELPER*********************************************

function helper(){
    document.querySelector(".dialog-helper").classList.toggle("is-hidden");
    // alert("HELPER ACTIVATED")
}

//helper enable


function makeResizableDiv(div) {
    const element = document.querySelector(div);
    const resizers = document.querySelector(".section-helper-drag")
    const minimum_size = 20;
    let original_height = 0;
    let original_y = 0;
    let original_mouse_y = 0;
        resizers.addEventListener('mousedown', function(e) {
            e.preventDefault()
            original_height = parseFloat(getComputedStyle(element, null).getPropertyValue('height').replace('px', ''));
            
            original_y = element.getBoundingClientRect().top;
            
            original_mouse_y = e.pageY;
            window.addEventListener('mousemove', resize)
            window.addEventListener('mouseup', stopResize)
        })
        
        function resize(e) {
            
            const height = original_height - (e.pageY - original_mouse_y);
            
            if (height > minimum_size) {
                element.style.height = height + 'px'
                element.style.top = original_y + (e.pageY - original_mouse_y) + 'px'
            }
            
            
        }
        
        function stopResize() {
            window.removeEventListener('mousemove', resize)
        }
        // }
    }
    
    makeResizableDiv('.section-helper')
    
// HELPER ************************

    const btnTitle = document.querySelector("#btn-generate-title"),
    dialogHelperTitle = document.querySelector("#textarea-dialog-title");
    let userInput = null;

    btnTitle.onclick = () => {

        userInput = `Create three 20-word-or-less titles in "Affected system - Issue Description" format. Include the error message in the description if present. Output titles only.: "${dialogHelperTitle.value}"`;
        if(dialogHelperTitle.value.length =! 0 && dialogHelperTitle.value.length > 10){
            // console.log("SUCCESS!")
            // console.log(userInput)
            generateAPIresponse();
        }
    }

    // API CONFIG
    const API_KEY = "AIzaSyDIPmiRin6MolQ-IvH6KWT2Vv6xki3tA1w";
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
    
    
    // HELPER
    const generateAPIresponse = async () => {
        try{
            const response = await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type" : "application/json" },
                body: JSON.stringify({
                    contents: [{
                        role: "user",
                        parts: [{ text: userInput }]
                    }]
                })
            })

            const data = await response.json();
            const apiResponse = data?.candidates[0].content.parts[0].text;
            document.querySelector("#textarea-dialog-title-result").value = apiResponse;
        } catch (err) {
            console.log(err)
        }
    }
    

    // FOR TRANSLATE

    const btnCorrection = document.querySelector("#btn-generate-correction"),
    dialogHelperCorrection = document.querySelector("#textarea-dialog-correction");
    let userInputCorrection = null;

    btnCorrection.onclick = () => {

        userInputCorrection = `AI Rephrase: Translate if needed the given sentence, professional English and provide three grammatically correct examples. also give 3 semi formal example Output only the translations, no explanation."${dialogHelperCorrection.value}"`;
        if(dialogHelperCorrection.value.length =! 0 && dialogHelperCorrection.value.length > 10){
            // console.log("SUCCESS!")
            // console.log(userInput)
            generateAPIresponseCorrect();
        }
    }
    
    const generateAPIresponseCorrect = async () => {
        try{
            const response = await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type" : "application/json" },
                body: JSON.stringify({
                    contents: [{
                        role: "user",
                        parts: [{ text: userInputCorrection }]
                    }]
                })
            })

            const data = await response.json();
            const apiResponse = data?.candidates[0].content.parts[0].text;
            document.querySelector("#textarea-dialog-correction-result").value = apiResponse;
        } catch (err) {
            console.log(err)
        }
    }


    // FOR Bullet

    const btnBullet = document.querySelector("#btn-generate-bullet"),
    dialogHelperBullet = document.querySelector("#textarea-dialog-bullet");
    let userInputBullet = null;

    btnBullet.onclick = () => {

        userInputBullet = `Format text input into a bulleted (use ascii arrow instead), step-by-step procedure. analyze the input, translate to English if needed, do not explain, Include details where relevant and enclose "issues found"/"no issues found" in parentheses ONLY if needed, aslo include result usually encapsulated with parenthesis."${dialogHelperBullet.value}"`;
        if(dialogHelperBullet.value.length =! 0 && dialogHelperBullet.value.length > 10){
            generateAPIresponseBullet();
        }
    }
    
    const generateAPIresponseBullet = async () => {
        try{
            const response = await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type" : "application/json" },
                body: JSON.stringify({
                    contents: [{
                        role: "user",
                        parts: [{ text: userInputBullet }]
                    }]
                })
            })

            const data = await response.json();
            const apiResponse = data?.candidates[0].content.parts[0].text;
            document.querySelector("#textarea-dialog-bullet-result").value = apiResponse;
        } catch (err) {
            console.log(err)
        }
    }














//REMOVE LATER
//dialogPop();




    </script>
</body>
</html>